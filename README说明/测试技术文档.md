# HarmonyOS è®°è´¦åº”ç”¨ - æµ‹è¯•æŠ€æœ¯æ–‡æ¡£

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯
- **ç‰ˆæœ¬**: 1.0.0
- **åˆ›å»ºæ—¥æœŸ**: 2025-11-08
- **æµ‹è¯•æ¡†æ¶**: Hypium 1.0.6
- **æµ‹è¯•ç±»å‹**: å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€UIæµ‹è¯•

---

## ğŸ“š ç›®å½•
1. [æµ‹è¯•æ¡†æ¶æ¦‚è¿°](#æµ‹è¯•æ¡†æ¶æ¦‚è¿°)
2. [æµ‹è¯•ç¯å¢ƒé…ç½®](#æµ‹è¯•ç¯å¢ƒé…ç½®)
3. [æµ‹è¯•ç›®å½•ç»“æ„](#æµ‹è¯•ç›®å½•ç»“æ„)
4. [æµ‹è¯•åˆ†ç±»](#æµ‹è¯•åˆ†ç±»)
5. [è¿è¡Œæµ‹è¯•](#è¿è¡Œæµ‹è¯•)
6. [ç¼–å†™æµ‹è¯•ç”¨ä¾‹](#ç¼–å†™æµ‹è¯•ç”¨ä¾‹)
7. [æµ‹è¯•è¦†ç›–ç‡](#æµ‹è¯•è¦†ç›–ç‡)
8. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## æµ‹è¯•æ¡†æ¶æ¦‚è¿°

### Hypium æµ‹è¯•æ¡†æ¶
æœ¬é¡¹ç›®ä½¿ç”¨ HarmonyOS å®˜æ–¹çš„ **Hypium** æµ‹è¯•æ¡†æ¶è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚

**ç‰¹ç‚¹**:
- âœ… æ”¯æŒå•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€UIæµ‹è¯•
- âœ… æä¾›ä¸°å¯Œçš„æ–­è¨€API
- âœ… æ”¯æŒå¼‚æ­¥æµ‹è¯•
- âœ… æ”¯æŒæµ‹è¯•ç”Ÿå‘½å‘¨æœŸç®¡ç†
- âœ… é›†æˆåœ¨ DevEco Studio ä¸­

**ä¾èµ–é…ç½®** (`oh-package.json5`):
```json5
{
  "devDependencies": {
    "@ohos/hypium": "1.0.6"
  }
}
```

---

## æµ‹è¯•ç¯å¢ƒé…ç½®

### 1. æµ‹è¯•æ¨¡å—é…ç½®

**æ–‡ä»¶**: `entry/ohosTest/module.json5`

```json5
{
  "module": {
    "name": "ohosTest",
    "type": "har",
    "description": "Test module for entry",
    "deviceTypes": ["phone"],
    "abilities": [
      {
        "name": "TestAbility",
        "srcEntry": "./ets/testability/TestAbility.ets",
        "description": "Test Ability for Hypium",
        "icon": "$media:icon",
        "label": "$string:test_label",
        "exported": false
      }
    ]
  }
}
```

### 2. æµ‹è¯•å…¥å£é…ç½®

**æ–‡ä»¶**: `entry/ohosTest/ets/testability/TestAbility.ets`

è¿™æ˜¯æµ‹è¯•çš„å…¥å£ç‚¹ï¼Œè´Ÿè´£ï¼š
- åˆå§‹åŒ–æµ‹è¯•ç¯å¢ƒ
- åŠ è½½æµ‹è¯•å¥—ä»¶
- æ‰§è¡Œæ‰€æœ‰æµ‹è¯•ç”¨ä¾‹
- æŠ¥å‘Šæµ‹è¯•ç»“æœ

---

## æµ‹è¯•ç›®å½•ç»“æ„

```
entry/ohosTest/
â”œâ”€â”€ ets/
â”‚   â”œâ”€â”€ index.test.ets              # æµ‹è¯•å¥—ä»¶å…¥å£
â”‚   â””â”€â”€ test/
â”‚       â”œâ”€â”€ model/                  # Model å±‚æµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ Account.test.ets
â”‚       â”‚   â”œâ”€â”€ Bill.test.ets
â”‚       â”‚   â”œâ”€â”€ Budget.test.ets
â”‚       â”‚   â”œâ”€â”€ Category.test.ets
â”‚       â”‚   â”œâ”€â”€ Statistics.test.ets
â”‚       â”‚   â””â”€â”€ User.test.ets
â”‚       â”œâ”€â”€ dao/                    # DAO å±‚æµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ AccountDAO.test.ets
â”‚       â”‚   â”œâ”€â”€ BillDAO.test.ets
â”‚       â”‚   â”œâ”€â”€ BudgetDAO.test.ets
â”‚       â”‚   â”œâ”€â”€ CategoryDAO.test.ets
â”‚       â”‚   â”œâ”€â”€ StatisticsDAO.test.ets
â”‚       â”‚   â””â”€â”€ UserDAO.test.ets
â”‚       â”œâ”€â”€ pages/                  # é¡µé¢æµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ IndexPage.test.ets
â”‚       â”‚   â””â”€â”€ AddBillPage.test.ets
â”‚       â”œâ”€â”€ services/               # ä¸šåŠ¡é€»è¾‘æµ‹è¯•
â”‚       â”‚   â””â”€â”€ Transaction.test.ets
â”‚       â””â”€â”€ testability/            # æµ‹è¯•èƒ½åŠ›
â”‚           â””â”€â”€ TestAbility.ets
â”œâ”€â”€ resources/                      # æµ‹è¯•èµ„æº
â””â”€â”€ module.json5                    # æµ‹è¯•æ¨¡å—é…ç½®
```

---

## æµ‹è¯•åˆ†ç±»

### 1. Model å±‚æµ‹è¯• (å•å…ƒæµ‹è¯•)

**ç›®çš„**: æµ‹è¯•æ•°æ®æ¨¡å‹çš„éªŒè¯ã€åºåˆ—åŒ–ã€ååºåˆ—åŒ–ç­‰åŠŸèƒ½

**æµ‹è¯•å†…å®¹**:
- âœ… æ•°æ®éªŒè¯ (`validate()`)
- âœ… JSON åºåˆ—åŒ– (`toJSON()`)
- âœ… JSON ååºåˆ—åŒ– (`fromJSON()`)
- âœ… å¯¹è±¡å…‹éš† (`clone()`)
- âœ… è¾¹ç•Œæ¡ä»¶æµ‹è¯•
- âœ… å¼‚å¸¸æƒ…å†µå¤„ç†

**ç¤ºä¾‹**: `Account.test.ets`
```typescript
import { describe, it, expect } from '@ohos/hypium';
import { Account } from '../../../../src/main/ets/model/Account';

export default function AccountTest(): void {
  describe('Account.validate()', () => {
    it('valid account should pass', 0, () => {
      const acc = new Account(1, 1, 'æµ‹è¯•è´¦æˆ·', 'bank', 5000.0, '#1E90FF', '2025-11-05', 0);
      expect(acc.validate()).assertTrue();
    });

    it('invalid account should fail (empty name)', 0, () => {
      const acc = new Account(0, 1, '', 'bank', 5000.0, '#1E90FF', '', 0);
      expect(acc.validate()).assertFalse();
    });
  });
}
```

### 2. DAO å±‚æµ‹è¯• (é›†æˆæµ‹è¯•)

**ç›®çš„**: æµ‹è¯•æ•°æ®è®¿é—®å±‚çš„ CRUD æ“ä½œå’Œæ•°æ®åº“äº¤äº’

**æµ‹è¯•å†…å®¹**:
- âœ… æ•°æ®åº“åˆå§‹åŒ–
- âœ… æ’å…¥æ“ä½œ (`insert()`)
- âœ… æŸ¥è¯¢æ“ä½œ (`getById()`, `getAll()`)
- âœ… æ›´æ–°æ“ä½œ (`update()`)
- âœ… åˆ é™¤æ“ä½œ (`delete()`, `softDelete()`)
- âœ… æ‰¹é‡æ“ä½œ
- âœ… äº‹åŠ¡å¤„ç†
- âœ… å¤–é”®çº¦æŸéªŒè¯

**ç¤ºä¾‹**: `AccountDAO.test.ets`
```typescript
import { describe, beforeAll, it, expect } from '@ohos/hypium';
import { AccountDAO } from '../../../../src/main/ets/dao/AccountDAO';
import { DatabaseManager } from '../../../../src/main/ets/dao/DatabaseManager';
import common from '@ohos.app.ability.common';

export default function AccountDAOTest(): void {
  describe('AccountDAO CRUD', () => {
    beforeAll(async () => {
      const ctx = getContext() as common.Context;
      await DatabaseManager.initDatabase(ctx);
    });

    it('should insert and get account', 0, async () => {
      const acc = new Account(0, 1, 'æµ‹è¯•è´¦æˆ·', 'bank', 5000.0, '#1E90FF', '', 0);
      await AccountDAO.insert(acc);
      const retrieved = await AccountDAO.getById(1);
      expect(retrieved !== null).assertTrue();
    });
  });
}
```

### 3. é¡µé¢æµ‹è¯• (UIæµ‹è¯•)

**ç›®çš„**: æµ‹è¯•é¡µé¢ç»„ä»¶çš„æ¸²æŸ“å’Œäº¤äº’

**æµ‹è¯•å†…å®¹**:
- âœ… é¡µé¢åŠ è½½
- âœ… ç»„ä»¶æ¸²æŸ“
- âœ… ç”¨æˆ·äº¤äº’
- âœ… æ•°æ®ç»‘å®š
- âœ… é¡µé¢è·³è½¬

**ç¤ºä¾‹**: `IndexPage.test.ets`
```typescript
import { describe, it, expect } from '@ohos/hypium';

export default function IndexPageTest(): void {
  describe('Index Page', () => {
    it('should load page successfully', 0, () => {
      // é¡µé¢åŠ è½½æµ‹è¯•
      expect(true).assertTrue();
    });
  });
}
```

### 4. ä¸šåŠ¡é€»è¾‘æµ‹è¯• (é›†æˆæµ‹è¯•)

**ç›®çš„**: æµ‹è¯•å¤æ‚çš„ä¸šåŠ¡æµç¨‹

**æµ‹è¯•å†…å®¹**:
- âœ… è´¦å•æ·»åŠ æµç¨‹
- âœ… è´¦å•ç­›é€‰é€»è¾‘
- âœ… ç»Ÿè®¡è®¡ç®—
- âœ… æ•°æ®å…³è”

---

## è¿è¡Œæµ‹è¯•

### æ–¹æ³• 1: ä½¿ç”¨ DevEco Studio

1. **æ‰“å¼€æµ‹è¯•é…ç½®**
   - ç‚¹å‡»é¡¶éƒ¨å·¥å…·æ çš„è¿è¡Œé…ç½®ä¸‹æ‹‰èœå•
   - é€‰æ‹© "Edit Configurations..."

2. **åˆ›å»ºæµ‹è¯•é…ç½®**
   - ç‚¹å‡» "+" æ·»åŠ æ–°é…ç½®
   - é€‰æ‹© "OpenHarmony Test"
   - é…ç½®åç§°: "Run All Tests"
   - Module: entry
   - Test Type: All in Module

3. **è¿è¡Œæµ‹è¯•**
   - ç‚¹å‡»è¿è¡ŒæŒ‰é’® (ç»¿è‰²ä¸‰è§’å½¢)
   - æˆ–ä½¿ç”¨å¿«æ·é”® `Shift + F10`

4. **æŸ¥çœ‹æµ‹è¯•ç»“æœ**
   - æµ‹è¯•ç»“æœä¼šæ˜¾ç¤ºåœ¨åº•éƒ¨çš„ "Run" çª—å£
   - ç»¿è‰² âœ… è¡¨ç¤ºé€šè¿‡
   - çº¢è‰² âŒ è¡¨ç¤ºå¤±è´¥

### æ–¹æ³• 2: ä½¿ç”¨å‘½ä»¤è¡Œ

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
hdc shell aa test -b com.example.healthydiet -m ohosTest -s unittest OpenHarmonyTestRunner

# è¿è¡Œç‰¹å®šæµ‹è¯•ç±»
hdc shell aa test -b com.example.healthydiet -m ohosTest -s class AccountTest -s unittest OpenHarmonyTestRunner
```

### æ–¹æ³• 3: ä½¿ç”¨ hvigor

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
hvigorw test
```

---

## ç¼–å†™æµ‹è¯•ç”¨ä¾‹

### åŸºæœ¬ç»“æ„

```typescript
import { describe, beforeAll, afterAll, beforeEach, afterEach, it, expect } from '@ohos/hypium';

export default function MyTest(): void {
  describe('æµ‹è¯•å¥—ä»¶åç§°', () => {
    // åœ¨æ‰€æœ‰æµ‹è¯•å‰æ‰§è¡Œä¸€æ¬¡
    beforeAll(async () => {
      console.info('Setup before all tests');
    });

    // åœ¨æ‰€æœ‰æµ‹è¯•åæ‰§è¡Œä¸€æ¬¡
    afterAll(async () => {
      console.info('Cleanup after all tests');
    });

    // åœ¨æ¯ä¸ªæµ‹è¯•å‰æ‰§è¡Œ
    beforeEach(() => {
      console.info('Setup before each test');
    });

    // åœ¨æ¯ä¸ªæµ‹è¯•åæ‰§è¡Œ
    afterEach(() => {
      console.info('Cleanup after each test');
    });

    // æµ‹è¯•ç”¨ä¾‹
    it('æµ‹è¯•ç”¨ä¾‹æè¿°', 0, () => {
      // æµ‹è¯•ä»£ç 
      expect(1 + 1).assertEqual(2);
    });

    // å¼‚æ­¥æµ‹è¯•ç”¨ä¾‹
    it('å¼‚æ­¥æµ‹è¯•ç”¨ä¾‹', 0, async () => {
      const result = await someAsyncFunction();
      expect(result).assertTrue();
    });
  });
}
```

### å¸¸ç”¨æ–­è¨€

```typescript
// ç›¸ç­‰æ–­è¨€
expect(actual).assertEqual(expected);
expect(actual).assertNotEqual(expected);

// å¸ƒå°”æ–­è¨€
expect(value).assertTrue();
expect(value).assertFalse();

// ç©ºå€¼æ–­è¨€
expect(value).assertNull();
expect(value).assertNotNull();
expect(value).assertUndefined();
expect(value).assertNotUndefined();

// ç±»å‹æ–­è¨€
expect(value).assertInstanceOf(ClassName);

// æ•°ç»„æ–­è¨€
expect(array).assertContain(element);
expect(array).assertNotContain(element);

// å¼‚å¸¸æ–­è¨€
expect(() => { throw new Error('test'); }).assertThrowError('test');

// æ•°å€¼æ¯”è¾ƒ
expect(value).assertLarger(10);
expect(value).assertLess(100);
```

### æµ‹è¯•æœ€ä½³å®è·µ

#### 1. éµå¾ª AAA æ¨¡å¼

```typescript
it('should calculate total correctly', 0, () => {
  // Arrange (å‡†å¤‡)
  const bill1 = new Bill(0, 1, 1, 100, '', '2025-11-01', 'expense', '', '', 0);
  const bill2 = new Bill(0, 1, 1, 200, '', '2025-11-02', 'expense', '', '', 0);

  // Act (æ‰§è¡Œ)
  const total = bill1.amount + bill2.amount;

  // Assert (æ–­è¨€)
  expect(total).assertEqual(300);
});
```

#### 2. æµ‹è¯•å‘½åè§„èŒƒ

```typescript
// âœ… å¥½çš„å‘½å
it('should return null when account not found', 0, async () => { ... });
it('should throw error when amount is negative', 0, () => { ... });
it('should update balance after transaction', 0, async () => { ... });

// âŒ ä¸å¥½çš„å‘½å
it('test1', 0, () => { ... });
it('account test', 0, () => { ... });
```

#### 3. ç‹¬ç«‹æ€§åŸåˆ™

æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹åº”è¯¥ç‹¬ç«‹ï¼Œä¸ä¾èµ–å…¶ä»–æµ‹è¯•çš„æ‰§è¡Œç»“æœã€‚

```typescript
// âŒ é”™è¯¯ç¤ºä¾‹ - æµ‹è¯•ä¹‹é—´æœ‰ä¾èµ–
let sharedAccount: Account;

it('should create account', 0, async () => {
  sharedAccount = new Account(...);
  await AccountDAO.insert(sharedAccount);
});

it('should update account', 0, async () => {
  // ä¾èµ–ä¸Šä¸€ä¸ªæµ‹è¯•
  sharedAccount.balance = 1000;
  await AccountDAO.update(sharedAccount);
});

// âœ… æ­£ç¡®ç¤ºä¾‹ - æ¯ä¸ªæµ‹è¯•ç‹¬ç«‹
it('should create account', 0, async () => {
  const account = new Account(...);
  await AccountDAO.insert(account);
  const retrieved = await AccountDAO.getById(account.accountId);
  expect(retrieved).assertNotNull();
});

it('should update account', 0, async () => {
  // åˆ›å»ºè‡ªå·±çš„æµ‹è¯•æ•°æ®
  const account = new Account(...);
  await AccountDAO.insert(account);
  account.balance = 1000;
  await AccountDAO.update(account);
  const updated = await AccountDAO.getById(account.accountId);
  expect(updated?.balance).assertEqual(1000);
});
```

#### 4. æµ‹è¯•è¾¹ç•Œæ¡ä»¶

```typescript
describe('Account.validate()', () => {
  it('should pass with zero balance', 0, () => {
    const acc = new Account(1, 1, 'è´¦æˆ·', 'cash', 0, '#FFF', '', 0);
    expect(acc.validate()).assertTrue();
  });

  it('should fail with negative balance', 0, () => {
    const acc = new Account(1, 1, 'è´¦æˆ·', 'cash', -1, '#FFF', '', 0);
    expect(acc.validate()).assertFalse();
  });

  it('should fail with empty name', 0, () => {
    const acc = new Account(1, 1, '', 'cash', 100, '#FFF', '', 0);
    expect(acc.validate()).assertFalse();
  });
});
```

---

## æµ‹è¯•è¦†ç›–ç‡

### å½“å‰æµ‹è¯•è¦†ç›–æƒ…å†µ

| æ¨¡å— | æµ‹è¯•æ–‡ä»¶æ•° | è¦†ç›–ç‡ç›®æ ‡ | å½“å‰çŠ¶æ€ |
|------|-----------|-----------|---------|
| Model å±‚ | 6 | 90%+ | âœ… å·²å®ç° |
| DAO å±‚ | 6 | 80%+ | âœ… å·²å®ç° |
| é¡µé¢å±‚ | 2 | 60%+ | âš ï¸ éœ€å®Œå–„ |
| ä¸šåŠ¡é€»è¾‘ | 1 | 70%+ | âš ï¸ éœ€å®Œå–„ |

### æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡

**ä¼˜å…ˆçº§ P0 (å¿…é¡»æµ‹è¯•)**:
- âœ… Model æ•°æ®éªŒè¯
- âœ… DAO CRUD æ“ä½œ
- âœ… æ•°æ®åº“å¤–é”®çº¦æŸ
- âœ… è½¯åˆ é™¤åŠŸèƒ½

**ä¼˜å…ˆçº§ P1 (é‡è¦æµ‹è¯•)**:
- âš ï¸ é¡µé¢åŠ è½½å’Œæ¸²æŸ“
- âš ï¸ ç”¨æˆ·äº¤äº’æµç¨‹
- âš ï¸ æ•°æ®ç­›é€‰é€»è¾‘
- âš ï¸ ç»Ÿè®¡è®¡ç®—

**ä¼˜å…ˆçº§ P2 (å¯é€‰æµ‹è¯•)**:
- â³ æ€§èƒ½æµ‹è¯•
- â³ å‹åŠ›æµ‹è¯•
- â³ å…¼å®¹æ€§æµ‹è¯•

---

## å¸¸è§é—®é¢˜

### Q1: æµ‹è¯•è¿è¡Œå¤±è´¥ï¼Œæç¤ºæ•°æ®åº“æœªåˆå§‹åŒ–

**é—®é¢˜**:
```
Error: [XXX] Database not initialized
```

**è§£å†³æ–¹æ¡ˆ**:
åœ¨æµ‹è¯•å¥—ä»¶çš„ `beforeAll` ä¸­åˆå§‹åŒ–æ•°æ®åº“ï¼š

```typescript
import { DatabaseManager } from '../../../../src/main/ets/dao/DatabaseManager';
import common from '@ohos.app.ability.common';

beforeAll(async () => {
  const ctx = getContext() as common.Context;
  await DatabaseManager.initDatabase(ctx);
});
```

### Q2: å¼‚æ­¥æµ‹è¯•è¶…æ—¶

**é—®é¢˜**:
```
Test timeout after 5000ms
```

**è§£å†³æ–¹æ¡ˆ**:
ç¡®ä¿å¼‚æ­¥æµ‹è¯•ä½¿ç”¨ `async/await`ï¼š

```typescript
it('should insert data', 0, async () => {
  await AccountDAO.insert(account);  // ä½¿ç”¨ await
  const result = await AccountDAO.getById(1);
  expect(result).assertNotNull();
});
```

### Q3: æµ‹è¯•æ•°æ®æ±¡æŸ“

**é—®é¢˜**: æµ‹è¯•ä¹‹é—´ç›¸äº’å½±å“ï¼Œå¯¼è‡´ä¸ç¨³å®š

**è§£å†³æ–¹æ¡ˆ**:
1. åœ¨ `afterEach` ä¸­æ¸…ç†æµ‹è¯•æ•°æ®
2. ä½¿ç”¨å”¯ä¸€çš„æµ‹è¯•æ•°æ®æ ‡è¯†
3. ä½¿ç”¨äº‹åŠ¡å›æ»š

```typescript
afterEach(async () => {
  // æ¸…ç†æµ‹è¯•æ•°æ®
  await AccountDAO.delete(testAccountId);
});
```

### Q4: Model å­—æ®µå‘½åé—®é¢˜

**é—®é¢˜**: æµ‹è¯•ä¸­ä½¿ç”¨äº† `is_deleted` ä½† Model ä½¿ç”¨ `isDeleted`

**è§£å†³æ–¹æ¡ˆ**:
ç»Ÿä¸€ä½¿ç”¨é©¼å³°å‘½å `isDeleted`ï¼š

```typescript
// âœ… æ­£ç¡®
const acc = new Account(1, 1, 'è´¦æˆ·', 'cash', 100, '#FFF', '', 0);
expect(acc.isDeleted).assertEqual(0);

// âŒ é”™è¯¯
expect(acc.is_deleted).assertEqual(0);
```

### Q5: å¦‚ä½•æµ‹è¯•å¤–é”®çº¦æŸ

**è§£å†³æ–¹æ¡ˆ**:
æµ‹è¯•æ’å…¥æ— æ•ˆå¤–é”®æ—¶æ˜¯å¦æŠ›å‡ºå¼‚å¸¸ï¼š

```typescript
it('should throw error when account not exists', 0, async () => {
  const bill = new Bill(0, 999, 1, 100, '', '2025-11-01', 'expense', '', '', 0);
  try {
    await BillDAO.insert(bill);
    expect(false).assertTrue(); // ä¸åº”è¯¥æ‰§è¡Œåˆ°è¿™é‡Œ
  } catch (error) {
    expect(error.message).assertContain('Account');
  }
});
```

---

## æµ‹è¯•æ‰§è¡Œæµç¨‹

### 1. å‡†å¤‡é˜¶æ®µ
```
1. è¿æ¥æµ‹è¯•è®¾å¤‡/æ¨¡æ‹Ÿå™¨
2. å®‰è£…æµ‹è¯•åº”ç”¨
3. åˆå§‹åŒ–æµ‹è¯•ç¯å¢ƒ
```

### 2. æ‰§è¡Œé˜¶æ®µ
```
1. åŠ è½½æµ‹è¯•å¥—ä»¶
2. æ‰§è¡Œ beforeAll é’©å­
3. é€ä¸ªæ‰§è¡Œæµ‹è¯•ç”¨ä¾‹
   - beforeEach
   - æµ‹è¯•ç”¨ä¾‹
   - afterEach
4. æ‰§è¡Œ afterAll é’©å­
```

### 3. æŠ¥å‘Šé˜¶æ®µ
```
1. æ”¶é›†æµ‹è¯•ç»“æœ
2. ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
3. è¾“å‡ºåˆ°æ§åˆ¶å°/æ–‡ä»¶
```

---

## æµ‹è¯•æŠ¥å‘Šç¤ºä¾‹

```
ğŸš€ Test Suite Starting
ğŸ“¦ Running Model Tests...
  âœ… Account.validate() - valid account should pass
  âœ… Account.validate() - invalid account should fail (empty name)
  âœ… Account.toJSON() - should return correct structure
  âœ… Account.fromJSON() - should create correct instance

ğŸ“¦ Running DAO Tests...
  âœ… AccountDAO.insert() - should insert account
  âœ… AccountDAO.getById() - should retrieve account
  âœ… AccountDAO.update() - should update account
  âœ… AccountDAO.delete() - should delete account

ğŸ“¦ Running Page Tests...
  âœ… IndexPage - should load successfully
  âœ… AddBillPage - should render form

âœ… All tests completed!
Total: 10 tests
Passed: 10
Failed: 0
Duration: 2.5s
```

---

## ä¸‹ä¸€æ­¥è®¡åˆ’

### çŸ­æœŸ (1å‘¨å†…)
1. âœ… å®Œå–„ Model å±‚æµ‹è¯•
2. âœ… å®Œå–„ DAO å±‚æµ‹è¯•
3. â³ æ·»åŠ é¡µé¢äº¤äº’æµ‹è¯•
4. â³ æ·»åŠ ä¸šåŠ¡æµç¨‹æµ‹è¯•

### ä¸­æœŸ (2-4å‘¨)
1. â³ æé«˜æµ‹è¯•è¦†ç›–ç‡åˆ° 80%+
2. â³ æ·»åŠ æ€§èƒ½æµ‹è¯•
3. â³ æ·»åŠ é›†æˆæµ‹è¯•
4. â³ å»ºç«‹ CI/CD è‡ªåŠ¨åŒ–æµ‹è¯•

### é•¿æœŸ (1ä¸ªæœˆ+)
1. â³ å»ºç«‹æµ‹è¯•æ•°æ®ç®¡ç†ç³»ç»Ÿ
2. â³ æ·»åŠ ç«¯åˆ°ç«¯æµ‹è¯•
3. â³ æ€§èƒ½åŸºå‡†æµ‹è¯•
4. â³ æµ‹è¯•æŠ¥å‘Šè‡ªåŠ¨åŒ–

---

## å‚è€ƒèµ„æ–™

- [HarmonyOS æµ‹è¯•æ¡†æ¶æ–‡æ¡£](https://developer.harmonyos.com/cn/docs/documentation/doc-guides/ohos-openharmony-test-framework-0000001263160453)
- [Hypium API å‚è€ƒ](https://gitee.com/openharmony/testfwk_arkxtest)
- [å•å…ƒæµ‹è¯•æœ€ä½³å®è·µ](https://developer.harmonyos.com/cn/docs/documentation/doc-guides/ohos-unit-test-0000001263200661)

---

## é™„å½•

### A. æµ‹è¯•ç”¨ä¾‹æ¨¡æ¿

```typescript
import { describe, beforeAll, afterAll, it, expect } from '@ohos/hypium';

export default function MyTest(): void {
  describe('æµ‹è¯•å¥—ä»¶åç§°', () => {
    beforeAll(async () => {
      // åˆå§‹åŒ–ä»£ç 
    });

    afterAll(async () => {
      // æ¸…ç†ä»£ç 
    });

    it('æµ‹è¯•ç”¨ä¾‹æè¿°', 0, async () => {
      // Arrange
      const input = ...;

      // Act
      const result = await someFunction(input);

      // Assert
      expect(result).assertEqual(expected);
    });
  });
}
```

### B. å¿«æ·å‘½ä»¤

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
hdc shell aa test -b com.example.healthydiet -m ohosTest -s unittest OpenHarmonyTestRunner

# æŸ¥çœ‹æµ‹è¯•æ—¥å¿—
hdc hilog | grep "testTag"

# æ¸…ç†æµ‹è¯•æ•°æ®
hdc shell rm -rf /data/app/el2/100/database/com.example.healthydiet/

# é‡æ–°å®‰è£…æµ‹è¯•åº”ç”¨
hdc install -r entry-default-signed.hap
```

---

**æ–‡æ¡£ç»´æŠ¤**: è¯·åœ¨æ¯æ¬¡æµ‹è¯•æ¡†æ¶æ›´æ–°æˆ–æ·»åŠ æ–°æµ‹è¯•æ—¶æ›´æ–°æ­¤æ–‡æ¡£ã€‚
